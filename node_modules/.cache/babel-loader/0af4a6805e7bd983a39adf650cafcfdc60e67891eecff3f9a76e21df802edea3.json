{"ast":null,"code":"import Key from\"./Key\";import ServerError from\"./ServerError\";import AuthorizationError from\"./AuthorizationError\";function Request(action,params){const body={action:action,params:params};const response=fetch('https://api.valantis.store:41000/',{method:'POST',headers:{'Content-Type':'application/json;charset=utf-8','X-Auth':Key()},body:JSON.stringify(body)}).then(res=>{//обрабатываем ответ сервера (не ошибка для then)\nif(!res.ok){console.log(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0437\\u0430\\u043F\\u0440\\u043E\\u0441\\u0430 \".concat(body.action==\"get_ids\"?'id товаров':'данных о товарах',\" . \\u041A\\u043E\\u0434: \").concat(res.status));switch(res.status){case 500:throw new ServerError();break;case 401:throw new AuthorizationError();break;default:throw new Error();break;}}else{return res;}},e=>{throw e;}).then(res=>{//приводим строку ответа к объекту \nreturn res.json();},e=>{throw e;}).then(res=>{// фильтруем дубликаты для ответов в виде массивов с объектами\nif(body.action==\"get_ids\"||body.action==\"filter\"||body.action==\"get_fields\"){return res.result;}else{const tempArr=[];const uniqueRes=[];res.result.map(item=>{if(!tempArr.find(tempItem=>tempItem==item.id)){tempArr.push(item.id);uniqueRes.push(item);}});return uniqueRes;}},e=>{throw e;});return response;}export default Request;","map":{"version":3,"names":["Key","ServerError","AuthorizationError","Request","action","params","body","response","fetch","method","headers","JSON","stringify","then","res","ok","console","log","concat","status","Error","e","json","result","tempArr","uniqueRes","map","item","find","tempItem","id","push"],"sources":["C:/Users/kiril/Desktop/Практика/test-task-valantis/src/components/Request.jsx"],"sourcesContent":["import Key from \"./Key\";\r\nimport ServerError from \"./ServerError\";\r\nimport AuthorizationError from \"./AuthorizationError\";\r\n\r\nfunction Request(action, params) {\r\n  const body = {\r\n    action: action, \r\n    params: params\r\n  }\r\n  const response = fetch('https://api.valantis.store:41000/',\r\n    { method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json;charset=utf-8',\r\n      'X-Auth': Key()\r\n    },\r\n    body: JSON.stringify(body)\r\n    }\r\n  ).then((res) => { //обрабатываем ответ сервера (не ошибка для then)\r\n    if(!res.ok) {\r\n      console.log(`Ошибка запроса ${body.action == \"get_ids\" ? 'id товаров': 'данных о товарах'} . Код: ${res.status}`)\r\n      switch (res.status) {\r\n        case 500:\r\n          throw new ServerError\r\n          break;\r\n        case 401:\r\n          throw new AuthorizationError\r\n          break;\r\n      \r\n        default:\r\n          throw new Error\r\n          break;\r\n      }\r\n    } else {\r\n      return res\r\n    }\r\n  }, (e) => { throw e }).then((res) => { //приводим строку ответа к объекту \r\n    return res.json() \r\n  }, (e) => { throw e; }).then((res) => { // фильтруем дубликаты для ответов в виде массивов с объектами\r\n    if (body.action == \"get_ids\" || body.action == \"filter\" || body.action == \"get_fields\") {\r\n      return res.result\r\n    } else {\r\n      const tempArr = []\r\n      const uniqueRes = []\r\n      res.result.map((item) => {\r\n        if (!tempArr.find(tempItem => tempItem == item.id)) {\r\n          tempArr.push(item.id)\r\n          uniqueRes.push(item)\r\n        }\r\n      })\r\n      \r\n      return uniqueRes\r\n    }    \r\n  }, (e) => { throw e; })\r\n\r\n  return response\r\n}\r\n\r\nexport default Request"],"mappings":"AAAA,MAAO,CAAAA,GAAG,KAAM,OAAO,CACvB,MAAO,CAAAC,WAAW,KAAM,eAAe,CACvC,MAAO,CAAAC,kBAAkB,KAAM,sBAAsB,CAErD,QAAS,CAAAC,OAAOA,CAACC,MAAM,CAAEC,MAAM,CAAE,CAC/B,KAAM,CAAAC,IAAI,CAAG,CACXF,MAAM,CAAEA,MAAM,CACdC,MAAM,CAAEA,MACV,CAAC,CACD,KAAM,CAAAE,QAAQ,CAAGC,KAAK,CAAC,mCAAmC,CACxD,CAAEC,MAAM,CAAE,MAAM,CAChBC,OAAO,CAAE,CACP,cAAc,CAAE,gCAAgC,CAChD,QAAQ,CAAEV,GAAG,CAAC,CAChB,CAAC,CACDM,IAAI,CAAEK,IAAI,CAACC,SAAS,CAACN,IAAI,CACzB,CACF,CAAC,CAACO,IAAI,CAAEC,GAAG,EAAK,CAAE;AAChB,GAAG,CAACA,GAAG,CAACC,EAAE,CAAE,CACVC,OAAO,CAACC,GAAG,oFAAAC,MAAA,CAAmBZ,IAAI,CAACF,MAAM,EAAI,SAAS,CAAG,YAAY,CAAE,kBAAkB,4BAAAc,MAAA,CAAWJ,GAAG,CAACK,MAAM,CAAE,CAAC,CACjH,OAAQL,GAAG,CAACK,MAAM,EAChB,IAAK,IAAG,CACN,KAAM,IAAI,CAAAlB,WAAW,CAAD,CAAC,CACrB,MACF,IAAK,IAAG,CACN,KAAM,IAAI,CAAAC,kBAAkB,CAAD,CAAC,CAC5B,MAEF,QACE,KAAM,IAAI,CAAAkB,KAAK,CAAD,CAAC,CACf,MACJ,CACF,CAAC,IAAM,CACL,MAAO,CAAAN,GAAG,CACZ,CACF,CAAC,CAAGO,CAAC,EAAK,CAAE,KAAM,CAAAA,CAAC,CAAC,CAAC,CAAC,CAACR,IAAI,CAAEC,GAAG,EAAK,CAAE;AACrC,MAAO,CAAAA,GAAG,CAACQ,IAAI,CAAC,CAAC,CACnB,CAAC,CAAGD,CAAC,EAAK,CAAE,KAAM,CAAAA,CAAC,CAAE,CAAC,CAAC,CAACR,IAAI,CAAEC,GAAG,EAAK,CAAE;AACtC,GAAIR,IAAI,CAACF,MAAM,EAAI,SAAS,EAAIE,IAAI,CAACF,MAAM,EAAI,QAAQ,EAAIE,IAAI,CAACF,MAAM,EAAI,YAAY,CAAE,CACtF,MAAO,CAAAU,GAAG,CAACS,MAAM,CACnB,CAAC,IAAM,CACL,KAAM,CAAAC,OAAO,CAAG,EAAE,CAClB,KAAM,CAAAC,SAAS,CAAG,EAAE,CACpBX,GAAG,CAACS,MAAM,CAACG,GAAG,CAAEC,IAAI,EAAK,CACvB,GAAI,CAACH,OAAO,CAACI,IAAI,CAACC,QAAQ,EAAIA,QAAQ,EAAIF,IAAI,CAACG,EAAE,CAAC,CAAE,CAClDN,OAAO,CAACO,IAAI,CAACJ,IAAI,CAACG,EAAE,CAAC,CACrBL,SAAS,CAACM,IAAI,CAACJ,IAAI,CAAC,CACtB,CACF,CAAC,CAAC,CAEF,MAAO,CAAAF,SAAS,CAClB,CACF,CAAC,CAAGJ,CAAC,EAAK,CAAE,KAAM,CAAAA,CAAC,CAAE,CAAC,CAAC,CAEvB,MAAO,CAAAd,QAAQ,CACjB,CAEA,cAAe,CAAAJ,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}